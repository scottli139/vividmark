# VividMark 需求规格说明书

## 文档信息

| 项目 | 内容 |
|------|------|
| **文档名称** | VividMark 需求规格说明书 |
| **文档版本** | 1.0.0 |
| **最后更新** | 2026-02-26 |
| **产品名称** | VividMark |
| **产品定位** | 现代、轻量级 Markdown 编辑器 |

---

## 1. 文档概述

### 1.1 目的

本文档详细描述 VividMark Markdown 编辑器的功能需求、非功能需求和用户场景，作为开发、测试和验收的基准。

### 1.2 范围

本文档覆盖 VividMark v1.0 版本的全部功能需求，包括：
- 核心编辑功能
- 文件管理功能
- Markdown 扩展语法支持
- 用户界面与交互
- 性能与质量要求

### 1.3 术语表

| 术语 | 定义 |
|------|------|
| **WYSIWYG** | What You See Is What You Get，所见即所得编辑模式 |
| **GFM** | GitHub Flavored Markdown，GitHub 扩展 Markdown 语法 |
| **Source 模式** | 直接编辑 Markdown 源码的编辑模式 |
| **Preview 模式** | 只读预览渲染结果的查看模式 |
| **Split 模式** | 左右分屏，左侧源码右侧预览的编辑模式 |
| **Admonition** | MkDocs 风格的提示框语法（如 `::: tip`） |
| **PlantUML** | 文本方式绘制 UML 图表的领域特定语言 |

---

## 2. 产品概述

### 2.1 产品愿景

VividMark 是一款面向现代写作者的轻量级 Markdown 编辑器，提供类似 Typora 的沉浸式写作体验，同时保持对标准 Markdown 语法的完全兼容。

### 2.2 目标用户

1. **技术文档撰写者** - 需要编写包含代码块、图表、数学公式的技术文档
2. **博客作者** - 需要简洁高效的写作工具，支持图片和格式化
3. **开发者** - 需要编辑 README、文档、笔记的程序员
4. **学生/研究人员** - 需要编写包含数学公式的学术文档

### 2.3 产品特性概览

- ✅ 三种编辑模式（Source / Preview / Split）
- ✅ 实时 Markdown 预览与语法高亮
- ✅ 本地文件操作（打开、保存、拖拽）
- ✅ 图片插入与本地资源管理
- ✅ MkDocs 扩展语法（Admonitions、PlantUML）
- ✅ 国际化支持（中/英文）
- ✅ 深色/浅色主题
- ✅ 撤销/重做、自动保存

---

## 3. 功能需求

### 3.1 核心编辑功能

#### 3.1.1 编辑模式 [FR-001]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-001.1 | **Source 模式**：提供纯文本编辑体验，支持语法高亮 | P0 | ✅ |
| FR-001.2 | **Preview 模式**：只读渲染预览，支持打印样式 | P0 | ✅ |
| FR-001.3 | **Split 模式**：左右分屏，支持同步滚动 | P0 | ✅ |
| FR-001.4 | 模式切换通过工具栏按钮或快捷键完成 | P0 | ✅ |
| FR-001.5 | 记住用户上次使用的编辑模式 | P1 | ⬜ |

#### 3.1.2 文本编辑 [FR-002]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-002.1 | 支持标准 Markdown 语法（CommonMark） | P0 | ✅ |
| FR-002.2 | 支持 GFM 表格语法 | P0 | ✅ |
| FR-002.3 | 支持 GFM 任务列表（Checkbox）`- [ ]` | P0 | ⬜ |
| FR-002.4 | 支持代码块与语法高亮 | P0 | ✅ |
| FR-002.5 | 支持行内代码、粗体、斜体、删除线 | P0 | ✅ |
| FR-002.6 | 支持链接、图片、引用、分隔线 | P0 | ✅ |
| FR-002.7 | 支持六级标题层级 | P0 | ✅ |
| FR-002.8 | 支持有序/无序列表及嵌套 | P0 | ✅ |

#### 3.1.3 编辑辅助 [FR-003]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-003.1 | 提供格式化工具有栏（粗体、斜体、标题等） | P0 | ✅ |
| FR-003.2 | 支持表格插入对话框（行列自定义） | P1 | ✅ |
| FR-003.3 | 支持撤销/重做（Ctrl+Z / Ctrl+Shift+Z） | P0 | ✅ |
| FR-003.4 | 撤销栈应持久化到当前会话 | P1 | ✅ |
| FR-003.5 | 支持查找与替换 | P0 | ⬜ |
| FR-003.6 | 支持全文搜索 | P1 | ⬜ |

#### 3.1.4 数学公式支持 [FR-004]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-004.1 | 支持行内公式 `$...$` | P1 | ⬜ |
| FR-004.2 | 支持块级公式 `$$...$$` | P1 | ⬜ |
| FR-004.3 | 使用 KaTeX 进行渲染 | P1 | ⬜ |
| FR-004.4 | 支持公式编号与引用 | P2 | ⬜ |

### 3.2 文件管理功能

#### 3.2.1 文件操作 [FR-010]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-010.1 | 打开文件（对话框选择或拖拽） | P0 | ✅ |
| FR-010.2 | 保存文件（Ctrl+S） | P0 | ✅ |
| FR-010.3 | 另存为（Ctrl+Shift+S） | P0 | ✅ |
| FR-010.4 | 新建文件（Ctrl+N） | P0 | ✅ |
| FR-010.5 | 支持 `.md`, `.markdown`, `.txt` 扩展名 | P0 | ✅ |
| FR-010.6 | 打开文件夹（侧边栏文件树） | P1 | ⬜ |

#### 3.2.2 自动保存 [FR-011]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-011.1 | 检测到修改后 2 秒自动保存 | P1 | ✅ |
| FR-011.2 | 仅在文件已有关联路径时自动保存 | P1 | ✅ |
| FR-011.3 | 自动保存前在标题栏显示 "修改" 标记 | P1 | ✅ |

#### 3.2.3 最近文件 [FR-012]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-012.1 | 保存最近打开的 10 个文件 | P1 | ✅ |
| FR-012.2 | 最近文件列表持久化 | P1 | ✅ |
| FR-012.3 | 支持从列表快速打开 | P1 | ✅ |
| FR-012.4 | 不存在的文件自动从列表移除 | P2 | ⬜ |

#### 3.2.4 多标签页 [FR-013]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-013.1 | 同时打开多个文件标签 | P1 | ⬜ |
| FR-013.2 | 支持标签拖拽排序 | P2 | ⬜ |
| FR-013.3 | 关闭标签前提示未保存修改 | P1 | ⬜ |
| FR-013.4 | 支持标签页快捷键（Ctrl+Tab 切换） | P1 | ⬜ |

### 3.3 Markdown 扩展功能

#### 3.3.1 Admonitions 提示框 [FR-020]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-020.1 | 支持 `::: tip` 提示类型 | P1 | ✅ |
| FR-020.2 | 支持 `::: warning` 警告类型 | P1 | ✅ |
| FR-020.3 | 支持 `::: info` 信息类型 | P1 | ✅ |
| FR-020.4 | 支持 `::: note` 注意类型 | P1 | ✅ |
| FR-020.5 | 支持 `::: danger` 危险类型 | P1 | ✅ |
| FR-020.6 | 支持 `::: success` 成功类型 | P2 | ✅ |
| FR-020.7 | 支持自定义标题 `::: tip 自定义标题` | P1 | ✅ |
| FR-020.8 | 可折叠 Admonitions `??? note` | P2 | ⬜ |
| FR-020.9 | 嵌套 Admonitions 支持 | P2 | ⬜ |

#### 3.3.2 图表支持 [FR-021]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-021.1 | PlantUML 行内语法 `@startuml...@enduml` | P1 | ✅ |
| FR-021.2 | PlantUML 代码块语法 ` ```plantuml ``` ` | P1 | ✅ |
| FR-021.3 | 使用 PlantUML 在线服务渲染 | P1 | ✅ |
| FR-021.4 | PlantUML 本地离线渲染 | P2 | ⬜ |
| FR-021.5 | Mermaid 图表支持 | P2 | ⬜ |

#### 3.3.3 图片处理 [FR-022]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-022.1 | 支持插入本地图片文件 | P0 | ✅ |
| FR-022.2 | 插入时自动复制到 `./assets/` 目录 | P1 | ✅ |
| FR-022.3 | 使用相对路径引用图片 | P1 | ✅ |
| FR-022.4 | 预览时正确显示本地图片 | P0 | ✅ |
| FR-022.5 | 支持网络图片 URL | P1 | ✅ |
| FR-022.6 | 图片拖拽调整大小 | P2 | ⬜ |

### 3.4 用户界面功能

#### 3.4.1 主题与外观 [FR-030]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-030.1 | 支持深色/浅色模式切换 | P0 | ✅ |
| FR-030.2 | 主题偏好持久化 | P0 | ✅ |
| FR-030.3 | 支持自定义 CSS 主题 | P2 | ⬜ |
| FR-030.4 | 主题编辑器界面 | P3 | ⬜ |

#### 3.4.2 侧边栏功能 [FR-031]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-031.1 | 显示文档大纲（标题层级） | P0 | ✅ |
| FR-031.2 | 大纲项点击跳转到对应位置 | P0 | ✅ |
| FR-031.3 | 显示文档统计（字符数、词数、行数） | P0 | ✅ |
| FR-031.4 | 文件树浏览器 | P1 | ⬜ |
| FR-031.5 | 侧边栏可折叠 | P1 | ✅ |

#### 3.4.3 国际化 [FR-032]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-032.1 | 支持简体中文界面 | P1 | ✅ |
| FR-032.2 | 支持英文界面 | P1 | ✅ |
| FR-032.3 | 语言偏好持久化 | P1 | ✅ |
| FR-032.4 | 支持系统语言自动检测 | P2 | ✅ |

### 3.5 导出功能

#### 3.5.1 文档导出 [FR-040]

| ID | 需求描述 | 优先级 | 状态 |
|:---:|---------|:------:|:----:|
| FR-040.1 | 导出为 PDF | P1 | ⬜ |
| FR-040.2 | 导出为 HTML（独立文件） | P1 | ⬜ |
| FR-040.3 | 导出为 HTML（带样式） | P1 | ⬜ |
| FR-040.4 | 导出为 Word (.docx) | P2 | ⬜ |
| FR-040.5 | 导出时包含图片资源 | P1 | ⬜ |
| FR-040.6 | 打印预览与打印 | P1 | ⬜ |

---

## 4. 非功能需求

### 4.1 性能需求

| ID | 需求描述 | 目标值 |
|:---:|---------|--------|
| NFR-001 | 应用启动时间 | < 3 秒 |
| NFR-002 | 文件打开时间（< 1MB） | < 500ms |
| NFR-003 | 实时预览渲染延迟 | < 100ms |
| NFR-004 | 支持的最大文件大小 | > 10MB |
| NFR-005 | 大文件（> 1MB）编辑响应 | 无明显卡顿 |
| NFR-006 | 内存占用（空闲状态） | < 200MB |

### 4.2 可靠性需求

| ID | 需求描述 | 要求 |
|:---:|---------|------|
| NFR-010 | 自动保存恢复 | 崩溃后应能恢复未保存内容 |
| NFR-011 | 文件写入原子性 | 保存失败时不应损坏原文件 |
| NFR-012 | 错误处理 | 所有错误应有用户友好的提示 |
| NFR-013 | 日志记录 | 关键操作应记录诊断日志 |

### 4.3 兼容性需求

| ID | 需求描述 | 要求 |
|:---:|---------|------|
| NFR-020 | 标准 Markdown 兼容性 | 符合 CommonMark 规范 |
| NFR-021 | GFM 兼容性 | 支持 GitHub Flavored Markdown |
| NFR-022 | 跨平台支持 | macOS 10.15+, Windows 10+, Linux |
| NFR-023 | 文件编码 | 支持 UTF-8，兼容 UTF-8 with BOM |

### 4.4 可用性需求

| ID | 需求描述 | 要求 |
|:---:|---------|------|
| NFR-030 | 快捷键支持 | 支持标准编辑快捷键 |
| NFR-031 | 快捷键自定义 | 允许用户修改快捷键绑定 |
| NFR-032 | 无障碍支持 | 支持屏幕阅读器基础功能 |
| NFR-033 | 界面响应式 | 适配不同窗口尺寸 |

### 4.5 安全需求

| ID | 需求描述 | 要求 |
|:---:|---------|------|
| NFR-040 | 本地文件访问 | 仅访问用户明确选择的文件/目录 |
| NFR-041 | 网络请求 | PlantUML 等外部服务应明确告知用户 |
| NFR-042 | XSS 防护 | 预览渲染应过滤危险脚本 |

---

## 5. 用户场景

### 5.1 场景一：技术文档编写

**用户**：后端开发工程师  
**目标**：编写 API 文档，包含代码示例和 PlantUML 时序图

**流程**：
1. 打开 VividMark，新建文档
2. 使用 Markdown 编写文档结构
3. 插入代码块并选择语言获得语法高亮
4. 使用 `@startuml` 插入时序图
5. 使用 `::: tip` 添加提示框
6. 定期 Ctrl+S 保存，或依赖自动保存
7. 导出为 HTML 发布到团队 Wiki

**涉及需求**：FR-001, FR-002, FR-021, FR-020, FR-011, FR-040

### 5.2 场景二：博客文章写作

**用户**：独立博客作者  
**目标**：撰写图文并茂的博客文章

**流程**：
1. 打开已有 `.md` 文件或新建
2. 使用 Source 模式编写正文
3. 切换到 Split 模式查看效果
4. 通过工具栏插入本地图片
5. 图片自动复制到 `assets` 目录
6. 调整标题层级和格式
7. 导出为 Markdown 发布到博客平台

**涉及需求**：FR-001, FR-022, FR-031, FR-030

### 5.3 场景三：学术论文笔记

**用户**：研究生  
**目标**：记录数学推导和公式

**流程**：
1. 新建文档，切换到 Split 模式
2. 使用 `$...$` 输入行内公式
3. 使用 `$$...$$` 输入行间公式
4. 使用表格整理数据
5. 使用大纲视图导航文档结构
6. 导出为 PDF 提交给导师

**涉及需求**：FR-004, FR-002.2, FR-031, FR-040.1

---

## 6. 技术约束

### 6.1 技术栈

| 层级 | 技术 | 版本 |
|------|------|------|
| 前端框架 | React | 19.x |
| 桌面框架 | Tauri | 2.x |
| 后端语言 | Rust | 1.77+ |
| 构建工具 | Vite | 7.x |
| 样式方案 | Tailwind CSS | 4.x |
| 状态管理 | Zustand | 5.x |

### 6.2 依赖约束

- 必须支持离线使用（除 PlantUML 渲染外）
- 安装包大小应 < 100MB
- 不依赖外部运行时（如 Node.js、Python）

---

## 7. 附录

### 7.1 快捷键列表

| 快捷键 | 功能 | 状态 |
|--------|------|:----:|
| Ctrl+N | 新建文件 | ✅ |
| Ctrl+O | 打开文件 | ✅ |
| Ctrl+S | 保存文件 | ✅ |
| Ctrl+Shift+S | 另存为 | ✅ |
| Ctrl+Z | 撤销 | ✅ |
| Ctrl+Shift+Z / Ctrl+Y | 重做 | ✅ |
| Ctrl+F | 查找 | ⬜ |
| Ctrl+H | 替换 | ⬜ |
| Ctrl+B | 粗体 | ✅ |
| Ctrl+I | 斜体 | ✅ |
| Ctrl+K | 插入链接 | ✅ |
| Ctrl+Shift+L | 插入代码块 | ✅ |
| Ctrl+/ | 注释/取消注释 | ⬜ |

### 7.2 修订记录

| 版本 | 日期 | 作者 | 修改内容 |
|------|------|------|----------|
| 1.0.0 | 2026-02-26 | - | 初始版本，基于 v0.1.0 功能整理 |

---

## 8. 状态图例

| 符号 | 含义 |
|:----:|------|
| ✅ | 已实现 |
| ⬜ | 未实现 |
| 🚧 | 进行中 |

## 9. 优先级说明

| 级别 | 含义 | 处理策略 |
|:----:|------|----------|
| **P0** | 核心需求 | 必须在发布前实现 |
| **P1** | 重要需求 | 建议在发布前实现 |
| **P2** | 次要需求 | 可在后续版本实现 |
| **P3** | 增强需求 | 根据资源情况安排 |
